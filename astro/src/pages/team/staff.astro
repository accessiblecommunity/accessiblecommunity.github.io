---
import { getCollection } from 'astro:content';

import Layout from '../../layouts/Layout.astro';
import StaffVignette from '../../components/StaffVignette.astro';
import TeamHeading from '../../components/TeamHeading.astro';
import ThemedSection from '../../components/ThemedSection.astro';

import { isEmpty, intersection, sortBy } from 'lodash-es';

const staffProfiles = await getCollection('staff');
const mini = true;
const title = 'Staff';

const staff = sortBy(
  staffProfiles.filter((p) => isEmpty(intersection(p.data.tags, ['board', 'leadership']))),
  (p) => p.data.name.split(' ').slice(1).join(' ')
);

const crumbs = [{
  name: 'Home', href: '/',
}, {
  name: 'Team', href: '/team',
}];
---

<Layout title={title} crumbs={crumbs}>
  <TeamHeading slot="header">
    Our <strong>Staff</strong>
  </TeamHeading>
  <ThemedSection theme="secondary" style="subtle" fluid={true}>
    <ul class="list-inline text-center">
      { staff.map((stf) =>
        <li class="list-inline-item staff-list m-2">
          <div class="text-start bg-body shadow-sm rounded-1 p-2 pt-3 fs-4 w-100">
            <StaffVignette
              member={stf}
              firstNameOnly={true}
              highlightName={true}
              branded={true}
              valign="center"
              size="lg"
            />
          </div>
        </li>
      )}
    </ul>
  </ThemedSection>
</Layout>

<style is:global>
.staff-list {
  width: 18rem;
}
.staff-list .vignette-name {
  color: var(--bs-primary-text-emphasis);
  margin-bottom: -0.1em;
}
</style>